import{f as L,g as V,i as w,z as D}from"./chunk-BFTH3AA7.mjs";import"./chunk-5NVRKAXG.mjs";import"./chunk-RW4R7QTB.mjs";import"./chunk-6BP7UWZ6.mjs";import{Aa as I,pa as E}from"./chunk-G23IRTGB.mjs";import"./chunk-4KWPUDVF.mjs";import{b as B}from"./chunk-MDTOMF5B.mjs";import{d as z}from"./chunk-3RV33U4O.mjs";var e=z(B());var t={"bear-cacader-select-container":"_bear-cacader-select-container_1komr_2","bear-dropdown-box":"_bear-dropdown-box_1komr_16","employee-cascader-dropdown-box":"_employee-cascader-dropdown-box_1komr_22","employee-cascader-dropdown-tree":"_employee-cascader-dropdown-tree_1komr_26","employee-cascader-dropdown-right-box":"_employee-cascader-dropdown-right-box_1komr_64","check-box-group-box":"_check-box-group-box_1komr_71","bear-check-box":"_bear-check-box_1komr_74","plain-options-no-data":"_plain-options-no-data_1komr_81","plain-options-icon":"_plain-options-icon_1komr_89","plain-options-no-data-text":"_plain-options-no-data-text_1komr_93","search-map-list-box":"_search-map-list-box_1komr_131","search-map-item-box":"_search-map-item-box_1komr_138","search-map-item-box_active":"_search-map-item-box_active_1komr_159","bear-dropdown-has-tree-box":"_bear-dropdown-has-tree-box_1komr_162"};var H=g=>{let{plainOptions:r,checkedListOptions:{cascaderValue:n=[],setCascaderValue:a}}=g,k=(0,e.useMemo)(()=>r?.every(s=>n?.includes(s.id)),[r,n]),v=(0,e.useMemo)(()=>n?.length>0&&!k,[n,k]),S=s=>{s?.target?.checked?a((u=[])=>Array.from(new Set([...u,...r.map(d=>d.id)]))):r.forEach(u=>{a((d=[])=>{let x=[...d],C=x.indexOf(u.id);return C>-1&&x.splice(C,1),x})})},T=s=>{s.forEach(m=>{n?.indexOf(m)===-1&&a((d=[])=>Array.from(new Set([...d,m])))}),r.forEach(m=>{s.includes(m.id)||a((u=[])=>{let d=[...u],x=d.indexOf(m.id);return x>-1&&d.splice(x,1),d})})};return e.default.createElement("div",{className:t["employee-cascader-dropdown-right-box"]},r?.length>0?e.default.createElement(e.default.Fragment,null,e.default.createElement(w,{key:"all",className:t["bear-check-box"],indeterminate:v,onChange:S,checked:k},"All"),e.default.createElement(w.Group,{className:t["check-box-group-box"],value:n,onChange:T},r.map(s=>e.default.createElement(w,{key:s?.id,className:t["bear-check-box"],value:s?.id},e.default.createElement(V,{placement:"left",title:s?.name??""},s?.name))))):e.default.createElement("div",{className:t["plain-options-no-data"]},e.default.createElement("img",{src:I.STATUS.EMPTY_DATA,className:t["plain-options-icon"]}),e.default.createElement("div",{className:t["plain-options-no-data-text"]},"No data available")))},M=(g,r)=>{if(!(!r||r?.length<1))for(let n=0;n<r.length;n++){if(r[n]?.key===g)return r[n];if(r[n]?.children?.length>0){let a=M(g,r[n].children);if(a)return a}}},q=g=>{let{dataOption:{cascaderValue:r,setCascaderValue:n},cascaderOptions:a,allPlainOptionsMap:k,placeholder:v,dropdownHeight:S,selectAttr:T={}}=g,s=(0,e.useRef)(null),m=(0,e.useMemo)(()=>{let o={},c=l=>{for(let p=0;p<l.length;p++){let i=l[p],h=i?.detailList??[];for(let f=0;f<h?.length;f++)o[h[f].name]=h[f].id;i?.children?.length>0&&c(i.children)}};return c(a),o},[a]),[u,d]=(0,e.useState)([]);(0,e.useEffect)(()=>{let o=r?.map(c=>k.idMapToName[c])??[];d(o)},[r,k]);let x=o=>{let c=o?.map(l=>k.nameMapToId[l])??[];n(c)},[C,A]=(0,e.useState)(""),P=o=>{A(o)},O=()=>{A("")},[_,N]=(0,e.useState)(null),b=(0,e.useRef)(_),$=(0,e.useMemo)(()=>_?.key?[_?.key]:[],[_]),j=(0,e.useMemo)(()=>_?.detailList??[],[_]),G=(o,c)=>{c?.node,b.current=c?.node??null,N(b.current)};(0,e.useEffect)(()=>{if(!(a.length<1)){if(b?.current?.key){let o=M(b.current.key,a)??null;b.current=o}else b.current={detailList:a?.[0]?.detailList??[]};N(b.current),b?.current}},[a]);let y=(0,e.useMemo)(()=>a?.length<2&&(!a?.[0]?.children||a?.[0]?.children?.length<1)&&a?.[0]?.detailList?.length>0?a?.[0]?.detailList:null,[a]),F=()=>{if(C?.length>0){let o=Object.entries(m).filter(([c])=>c.toLowerCase().indexOf(C.toLowerCase())>-1);return e.default.createElement("div",{className:t["search-map-list-box"]},o.map(([c,l])=>e.default.createElement("div",{title:c,key:l,className:`${t["search-map-item-box"]} ${r?.includes(l)&&t["search-map-item-box_active"]}`,onClick:()=>{n((p=[])=>{let i=[...p],h=i.indexOf(l);if(h===-1){i.push(l);let f=o.every(([U,K])=>i.includes(K));f&&s?.current?.blur()}else i.splice(h,1);return i})}},c)))}return y?e.default.createElement("div",{className:t["search-map-list-box"]},y.map(o=>e.default.createElement("div",{title:o.name,key:o.id,className:`${t["search-map-item-box"]} ${r?.includes(o.id)&&t["search-map-item-box_active"]}`,onClick:()=>{n((c=[])=>{let l=[...c],p=l.indexOf(o.id);if(p===-1){l.push(o.id);let i=y.every(h=>l.includes(h.id));i&&s?.current?.blur()}else l.splice(p,1);return l})}},o.name))):e.default.createElement(e.default.Fragment,null,e.default.createElement(D,{className:t["employee-cascader-dropdown-tree"],blockNode:!0,defaultExpandAll:!0,selectedKeys:$,treeData:a,onSelect:G}),e.default.createElement(H,{plainOptions:j,checkedListOptions:{cascaderValue:r,setCascaderValue:n}}))};return e.default.createElement(L,{ref:s,className:t["bear-cacader-select-container"],placeholder:v,suffixIcon:e.default.createElement(E,{size:15}),mode:"multiple",size:"large",showSearch:!0,allowClear:!0,value:u,onSearch:P,onFocus:O,onClear:O,onChange:x,placement:"bottomLeft",getPopupContainer:o=>o.parentNode,popupClassName:`${t["bear-dropdown-box"]} ${C.length<1&&!y?t["bear-dropdown-has-tree-box"]:""}`,dropdownRender:()=>e.default.createElement("div",{className:t["employee-cascader-dropdown-box"],style:{height:S??"32vh"}},F()),...T})},oe=q;export{oe as default};
